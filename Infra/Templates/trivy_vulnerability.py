import json
informe_json = "results.json"

try:
    with open(informe_json, "r") as file:
        data = json.load(file)
    critical_count = 0
    high_count = 0
    medium_count = 0
    low_count = 0
    for result in data.get("Results", []):
        vulnerabilities = result.get("Vulnerabilities", [])
        for vulnerability in vulnerabilities:
            severity = vulnerability.get("Severity", "").upper()
            if severity == "CRITICAL":
                critical_count += 1
            elif severity == "HIGH":
                high_count += 1
            elif severity == "MEDIUM":
                medium_count += 1
            elif severity == "LOW":
                low_count += 1

    print("Resumen de Vulnerabilidades Trivy:")
    print("==========================================")                
    print("Vulnerabilidades Cr√≠ticas:", critical_count)
    print("Vulnerabilidades de Alta Severidad:", high_count)
    print("Vulnerabilidades de Severidad Media:", medium_count)
    print("Vulnerabilidades de Baja Severidad:", low_count)
    print("==========================================")

except FileNotFoundError:
    print(f"El archivo de informe JSON '{informe_json}' no existe.")
except json.JSONDecodeError as e:
    print(f"Error al analizar el archivo JSON: {e}")