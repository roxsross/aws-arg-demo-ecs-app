import json

informe_json = "horusec.json"
try:
    # Abre el archivo JSON y parsea su contenido
    with open(informe_json, "r") as file:
        data = json.load(file)
    critical_count = 0
    high_count = 0
    medium_count = 0
    low_count = 0
    unknown = 0

    for vulnerability in data["analysisVulnerabilities"]:
        severity = vulnerability["vulnerabilities"]["severity"]
        
        if severity == "CRITICAL" :
            critical_count += 1
        elif severity == "HIGH":
            high_count += 1
        elif severity == "MEDIUM":
            medium_count += 1
        elif severity == "LOW":
            low_count += 1
        elif severity == "UNKNOWN":
            unknown += 1

    print("Resumen de Vulnerabilidades Horusec:")
    print("==========================================")
    print("Vulnerabilidades Críticas:", critical_count)
    print("Vulnerabilidades de Alta Severidad:", high_count)
    print("Vulnerabilidades de Severidad Media:", medium_count)
    print("Vulnerabilidades de Baja Severidad:", low_count)
    print("Vulnerabilidades desconocidas:", unknown)
    print("==========================================")
    
except FileNotFoundError:
    print(f"El archivo '{informe_json}' no se encontró.")
except json.JSONDecodeError:
    print(f"No se pudo decodificar el archivo JSON '{informe_json}'. Verifica su formato.")